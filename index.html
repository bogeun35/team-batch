<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° Ï∞∏Ïä§ÏΩîÎìú ÌîÑÎ°úÍ∑∏Îû®</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
        
        :root {
            --ow-orange: #FF9C00;
            --ow-blue: #00D3FF;
            --ow-dark: #0d1117;
            --ow-darker: #010409;
            --ow-gray: #1c2128;
            --ow-white: #f0f6fc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0a0e27 100%);
            min-height: 100vh;
            color: #fff;
            overflow: hidden;
        }

        .container {
            max-width: 100vw;
            max-height: 100vh;
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 15px;
            gap: 15px;
        }

        .header {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, rgba(255,107,0,0.2) 0%, rgba(255,0,128,0.2) 100%);
            border: 2px solid rgba(255,107,0,0.5);
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255,107,0,0.3);
        }

        .header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            letter-spacing: 3px;
            background: linear-gradient(135deg, var(--ow-blue), var(--ow-white), var(--ow-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: none;
        }

        .header-subtitle { 
            font-size: 0.9em; 
            color: rgba(255,255,255,0.5); 
            letter-spacing: 0.2em; 
        }

        .main-layout {
            display: flex;
            gap: 15px;
            flex: 1;
            overflow: hidden;
        }

        .left-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
        }

        .right-sidebar {
            width: 350px;
            background: rgba(26, 31, 58, 0.8);
            border: 2px solid rgba(0, 150, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0, 150, 255, 0.2);
        }

        .controls {
            background: rgba(26, 31, 58, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid rgba(0, 150, 255, 0.3);
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-balanced {
            background: linear-gradient(135deg, #ff6b00 0%, #ff8800 100%);
            box-shadow: 0 5px 15px rgba(255,107,0,0.4);
        }

        .btn-spectator {
            background: linear-gradient(135deg, #9c27b0 0%, #e040fb 100%);
            box-shadow: 0 5px 15px rgba(156,39,176,0.4);
        }

        .btn-auction {
            background: linear-gradient(135deg, #f50057 0%, #ff4081 100%);
            box-shadow: 0 5px 15px rgba(245,0,87,0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #455a64 0%, #607d8b 100%);
            box-shadow: 0 5px 15px rgba(69,90,100,0.4);
        }

        .btn-add-all { background: linear-gradient(135deg, #48bb78, #2f855a); color: white; }
        .btn-reset-spectator { background: linear-gradient(135deg, #6b7280, #4b5563); color: white; }
        .btn:hover {
            transform: translateY(-3px);
            filter: brightness(1.2);
        }

        .teams-container {
            background: rgba(26, 31, 58, 0.8);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid rgba(0, 150, 255, 0.3);
            flex: 1;
            overflow-y: auto;
        }

        .teams-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .team {
            background: linear-gradient(135deg, rgba(0,0,0,0.5) 0%, rgba(26,31,58,0.8) 100%);
            border-radius: 10px;
            padding: 20px;
            border: 2px solid;
        }

        .team.team1 {
            border-color: rgba(33, 150, 243, 0.6);
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.3);
        }

        .team.team2 {
            border-color: rgba(244, 67, 54, 0.6);
            box-shadow: 0 0 20px rgba(244, 67, 54, 0.3);
        }

        .team-header {
            font-size: 1.5em;
            font-weight: 900;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-transform: uppercase;
        }

        .team1 .team-header {
            border-color: rgba(33, 150, 243, 0.6);
            color: #2196f3;
            text-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }

        .team2 .team-header {
            border-color: rgba(244, 67, 54, 0.6);
            color: #f44336;
            text-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }

        .team-score {
            font-size: 0.6em;
            background: rgba(255,255,255,0.1);
            padding: 5px 15px;
            border-radius: 20px;
        }

        .team-slots {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .team-slot {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            min-height: 60px;
            border: 2px dashed rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .team-slot.drag-over {
            background: rgba(255,107,0,0.3);
            border-color: #ff6b00;
            transform: scale(1.05);
        }

        .team-slot.empty::after {
            content: 'Îπà ÏûêÎ¶¨';
            color: rgba(255,255,255,0.3);
            font-weight: 700;
            letter-spacing: 2px;
        }

        .player-card {
            background: linear-gradient(135deg, rgba(255,107,0,0.8) 0%, rgba(255,0,128,0.8) 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: move;
            font-weight: 700;
            text-align: center;
            box-shadow: 0 5px 15px rgba(255,107,0,0.5);
            transition: all 0.3s;
            user-select: none;
            width: 100%;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .player-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(255,107,0,0.7);
        }

        .player-card.dragging {
            opacity: 0.5;
        }

        .player-card .tier-label {
            font-size: 0.8em;
            background: rgba(0,0,0,0.5);
            padding: 3px 10px;
            border-radius: 10px;
            display: inline-block;
            margin-top: 5px;
        }

        .player-card .role-label {
            font-size: 0.7em;
            background: rgba(0,0,0,0.3);
            padding: 2px 6px;
            border-radius: 8px;
            display: inline-block;
            margin-top: 3px;
        }

        .vs-divider {
            font-size: 4em;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b00 0%, #ff0080 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }

        .score-diff {
            font-size: 0.3em;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 20px;
            color: #fff;
        }

        .score-diff.balanced {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
        }

        .spectators {
            background: linear-gradient(135deg, rgba(0,0,0,0.5) 0%, rgba(26,31,58,0.8) 100%);
            border-radius: 10px;
            padding: 20px;
            border: 2px solid rgba(156, 39, 176, 0.6);
            box-shadow: 0 0 20px rgba(156, 39, 176, 0.3);
        }

        .spectators-header {
            font-size: 1.3em;
            font-weight: 900;
            margin-bottom: 15px;
            color: #e040fb;
            text-shadow: 0 0 10px rgba(224, 64, 251, 0.5);
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
        }

        .spectators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
            min-height: 80px;
        }

        .spectators-grid.empty::after {
            content: 'Í¥ÄÏ†ÑÏûê ÏóÜÏùå';
            color: rgba(255,255,255,0.3);
            font-weight: 700;
            letter-spacing: 2px;
            grid-column: 1 / -1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .spectators-grid {
            max-height: 100px;
            overflow-y: auto;
        }

        .spectator-card {
            background: linear-gradient(135deg, rgba(156,39,176,0.8) 0%, rgba(224,64,251,0.8) 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: move;
            font-weight: 700;
            text-align: center;
            box-shadow: 0 5px 15px rgba(156,39,176,0.5);
            transition: all 0.3s;
            border: 2px solid rgba(255,255,255,0.3);
            position: relative;
        }

        .spectator-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(156,39,176,0.7);
        }

        .spectator-card .remove-spectator-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(244,67,54,0.9);
            border: none;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .sidebar-section-title {
            font-size: 16px;
            font-weight: 900;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        .saved-players {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .saved-player-tag {
            background: linear-gradient(135deg, rgba(0,150,255,0.6) 0%, rgba(0,212,255,0.6) 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 700;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .saved-player-tag:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,150,255,0.5);
        }

        .saved-player-tag.in-spectator {
            background: linear-gradient(135deg, rgba(156,39,176,0.6) 0%, rgba(224,64,251,0.6) 100%);
        }

        .saved-player-tag.in-team {
            background: rgba(100,100,100,0.5);
            cursor: default;
        }

        .input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .player-name-input {
            flex: 1;
            padding: 12px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(0,150,255,0.5);
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            font-weight: 700;
        }

        .player-name-input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
        }

        .tier-input {
            width: 70px;
            padding: 12px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(255,107,0,0.5);
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            font-weight: 700;
            text-align: center;
        }

        .add-player-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
        }

        .add-player-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.5);
        }

        .template-section {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid rgba(0,150,255,0.3);
        }

        .template-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .template-btn {
            padding: 8px 12px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(0,150,255,0.5);
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            font-size: 12px;
            font-weight: 700;
            transition: all 0.3s;
        }

        .template-btn.active {
            background: linear-gradient(135deg, #0096ff 0%, #00d4ff 100%);
            border-color: #00d4ff;
        }

        /* Ïò§Î≤ÑÏõåÏπò Ïä§ÌÉÄÏùº Í≤ΩÎß§ Î™®Îã¨ */
        .auction-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .auction-modal.active {
            display: flex;
        }

        .auction-content {
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            border: 3px solid #ff6b00;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 0 50px rgba(255,107,0,0.5);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .auction-player {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, rgba(255,107,0,0.3) 0%, rgba(255,0,128,0.3) 100%);
            border-radius: 10px;
            border: 2px solid rgba(255,107,0,0.5);
        }

        .auction-player-name {
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b00 0%, #ff0080 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255,107,0,0.5);
            margin-bottom: 10px;
        }

        .auction-timer {
            text-align: center;
            font-size: 4em;
            font-weight: 900;
            color: #00d4ff;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.8);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .auction-timer.warning {
            color: #f44336;
            text-shadow: 0 0 20px rgba(244, 67, 54, 0.8);
        }

        .auction-battle {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            align-items: start;
        }

        .auction-team-side {
            background: rgba(0,0,0,0.5);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid;
            transition: all 0.5s;
        }

        .auction-team-side.team1-side {
            border-color: rgba(33, 150, 243, 0.6);
        }

        .auction-team-side.team2-side {
            border-color: rgba(244, 67, 54, 0.6);
        }

        .auction-team-side.winner {
            transform: scale(1.05);
            box-shadow: 0 0 40px currentColor;
            animation: winnerPulse 0.5s;
        }
        
        .auction-team-side.current-bidder {
            border-width: 3px;
            box-shadow: 0 0 30px currentColor;
            animation: bidPulse 1s infinite;
        }

        @keyframes bidPulse {
            0%, 100% { box-shadow: 0 0 20px currentColor; }
            50% { box-shadow: 0 0 40px currentColor; }
        }

        @keyframes winnerPulse {
            0%, 100% { transform: scale(1.05); }
            50% { transform: scale(1.1); }
        }

        .auction-team-captain {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .auction-team-members {
            font-size: 0.9em;
            margin-bottom: 15px;
            opacity: 0.7;
            max-height: 80px;
            overflow-y: auto;
        }

        .auction-points-config {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .auction-points-inputs {
            display: flex;
            gap: 15px;
        }

        .auction-points-input-group {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .auction-points-input-group label {
            font-weight: 700;
            color: #00d4ff;
        }

        .auction-points-input-group input {
            flex: 1;
            padding: 8px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(0,150,255,0.5);
            border-radius: 6px;
            color: #fff;
            font-size: 14px;
            font-weight: 700;
            text-align: center;
        }

        .auction-team-name {
            font-size: 1.8em;
            font-weight: 900;
            margin-bottom: 15px;
            text-transform: uppercase;
        }

        .team1-side .auction-team-name {
            color: #2196f3;
            text-shadow: 0 0 15px rgba(33, 150, 243, 0.8);
        }

        .team2-side .auction-team-name {
            color: #f44336;
            text-shadow: 0 0 15px rgba(244, 67, 54, 0.8);
        }

        .auction-bid-input {
            width: 100%;
            padding: 15px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 1.5em;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
        }

        .auction-bid-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #ff6b00 0%, #ff0080 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .auction-bid-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(255,107,0,0.7);
        }

        .auction-vs {
            font-size: 5em;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b00 0%, #ff0080 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auction-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .auction-control-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .auction-pass-btn {
            background: linear-gradient(135deg, #607d8b 0%, #90a4ae 100%);
            color: white;
        }

        .auction-next-btn {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
        }

        .auction-close-btn {
            background: linear-gradient(135deg, #f44336 0%, #e91e63 100%);
            color: white;
        }

        .auction-remaining-players {
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .auction-remaining-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            max-height: 80px;
            overflow-y: auto;
        }

        .auction-remaining-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8em;
            color: rgba(255,255,255,0.6);
        }

        .auction-remaining-item.current {
            background: linear-gradient(135deg, var(--ow-orange), rgba(255,156,0,0.3));
            border-color: var(--ow-orange);
            color: white;
            font-weight: 700;
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #ff6b00 0%, #ff0080 100%);
            border-radius: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 999;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #ff6b00;
            max-width: 400px;
            width: 90%;
        }

        .modal-title {
            font-size: 1.5em;
            font-weight: 900;
            color: #ff6b00;
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-input {
            width: 100%;
            padding: 15px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(255,107,0,0.5);
            border-radius: 8px;
            color: #fff;
            font-size: 1.2em;
            text-align: center;
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn.save {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
        }

        .modal-btn.cancel {
            background: linear-gradient(135deg, #607d8b 0%, #90a4ae 100%);
            color: white;
        }

        @media (max-width: 968px) {
            .main-layout {
                flex-direction: column;
            }

            .right-sidebar {
                width: 100%;
                max-height: 300px;
            }

            .teams-grid {
                grid-template-columns: 1fr;
            }

            .auction-battle {
                grid-template-columns: 1fr;
            }

            .auction-vs {
                transform: rotate(90deg);
                margin: 20px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öΩ Ï∞∏Ïä§ÏΩîÎìú ÌîÑÎ°úÍ∑∏Îû®</h1>
            <div class="header-subtitle">CHAMSCODE AUCTION SYSTEM</div>
        </div>

        <div class="main-layout">
            <div class="left-content">
                <div class="controls">
                    <div class="action-buttons">
                        <button class="btn btn-balanced" id="balancedBtn">‚öñÔ∏è Î∞∏Îü∞Ïä§ ÎûúÎç§</button>
                        <button class="btn btn-spectator" id="spectatorRandomBtn">üë• Í¥ÄÏ†ÑÏûê ÎûúÎç§</button>
                        <button class="btn btn-auction" id="auctionBtn">üî® Í≤ΩÎß§ÌïòÍ∏∞</button>
                        <button class="btn btn-reset-spectator" id="resetToSpectatorBtn">‚¨áÔ∏è Î™®Îëê Í¥ÄÏ†ÑÏûêÎ°ú</button>
                        <button class="btn btn-add-all" id="addAllToSpectatorBtn">‚¨ÜÔ∏è Ï†ÑÏõê Í¥ÄÏ†Ñ</button>
                        <button class="btn btn-secondary" id="clearTeamsBtn">üîÑ Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî</button>
                    </div>
                </div>

                <div class="teams-container">
                    <div class="teams-grid">
                        <div class="team team1">
                            <div class="team-header">
                                <span>1ÌåÄ</span>
                                <span class="team-score" id="team1Score">0</span>
                            </div>
                            <div class="team-slots" id="team1"></div>
                        </div>

                        <div class="vs-divider">
                            <div>VS</div>
                            <div class="score-diff" id="scoreDiff">0</div>
                        </div>

                        <div class="team team2">
                            <div class="team-header">
                                <span>2ÌåÄ</span>
                                <span class="team-score" id="team2Score">0</span>
                            </div>
                            <div class="team-slots" id="team2"></div>
                        </div>
                    </div>

                    <div class="spectators">
                        <div class="spectators-header">
                            <span>üë• Í¥ÄÏ†ÑÏûê</span>
                            <span id="spectatorCount">0</span>
                        </div>
                        <div class="spectators-grid empty" id="spectatorsGrid"></div>
                    </div>
                </div>
            </div>

            <div class="right-sidebar">
                <div class="sidebar-section-title">üìã Ï∞∏Í∞ÄÏûê Ï∂îÍ∞Ä</div>
                <div class="input-row">
                    <input type="text" class="player-name-input" id="newPlayerInput" placeholder="Ïù¥Î¶Ñ">
                    <input type="number" class="tier-input" id="newTierInput" value="3" min="1">
                    <button class="add-player-btn" id="addPlayerBtn">+</button>
                </div>

                <div class="sidebar-section-title">üë§ Ï∞∏Í∞ÄÏûê Î™©Î°ù</div>
                <div class="saved-players" id="savedPlayers">
                    <span style="color: rgba(255,255,255,0.3);">Ï∞∏Í∞ÄÏûê ÏóÜÏùå</span>
                </div>

                <div class="sidebar-section-title">üë• Í¥ÄÏ†ÑÏûê</div>
                <div class="saved-players" id="sidebarSpectators">
                    <span style="color: rgba(255,255,255,0.3);">Í¥ÄÏ†ÑÏûê ÏóÜÏùå</span>
                </div>

                <div class="template-section">
                    <div style="font-size: 14px; font-weight: 700; margin-bottom: 10px; color: #00d4ff;">ÌÖúÌîåÎ¶ø</div>
                    <div class="template-buttons" id="templateButtons"></div>
                    <div style="display: flex; gap: 8px; margin-top: 10px;">
                        <button class="template-btn" style="flex: 1;" id="saveTemplateBtn">üíæ Ï†ÄÏû•</button>
                        <button class="template-btn" style="flex: 1;" id="renameTemplateBtn">‚úèÔ∏è Ïù¥Î¶ÑÎ≥ÄÍ≤Ω</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="auction-modal" id="auctionModal">
        <div class="auction-content">
            <div class="auction-player">
                <div class="auction-player-name" id="auctionPlayerName">ÌîåÎ†àÏù¥Ïñ¥</div>
                <div style="font-size: 1.2em; color: #00d4ff;" id="auctionPlayerTier">Ìã∞Ïñ¥: 3</div>
            </div>

            <div class="auction-timer" id="auctionTimer">6</div>

            <div class="auction-points-config">
                <div style="font-size: 14px; font-weight: 700; margin-bottom: 10px; color: #00d4ff; text-align: center;">Ìè¨Ïù∏Ìä∏ ÏÑ§Ï†ï</div>
                <div class="auction-points-inputs">
                    <div class="auction-points-input-group">
                        <label>1ÌåÄ:</label>
                        <input type="number" id="auctionTeam1PointsInput" min="0">
                    </div>
                    <div class="auction-points-input-group">
                        <label>2ÌåÄ:</label>
                        <input type="number" id="auctionTeam2PointsInput" min="0">
                    </div>
                </div>
            </div>

            <div class="auction-battle">
                <div class="auction-team-side team1-side" id="auctionTeam1Side">
                    <div class="auction-team-name" id="auctionTeam1Name">1ÌåÄ</div>
                    <div class="auction-team-captain" id="auctionTeam1Captain">ÌåÄÏû•: -</div>
                    <div class="auction-team-members" id="auctionTeam1Members">Íµ¨ÏÑ±Ïõê ÏóÜÏùå</div>
                    <div style="color: #00d4ff; font-size: 1.5em; font-weight: 900; margin-bottom: 15px;" id="auctionTeam1Points">100P</div>
                    <input type="number" class="auction-bid-input" id="team1BidInput" placeholder="ÏûÖÏ∞∞Í∞Ä" min="0">
                    <button class="auction-bid-btn" id="team1BidBtn">ÏûÖÏ∞∞</button>
                </div>

                <div class="auction-vs">VS</div>

                <div class="auction-team-side team2-side" id="auctionTeam2Side">
                    <div class="auction-team-name" id="auctionTeam2Name">2ÌåÄ</div>
                    <div class="auction-team-captain" id="auctionTeam2Captain">ÌåÄÏû•: -</div>
                    <div class="auction-team-members" id="auctionTeam2Members">Íµ¨ÏÑ±Ïõê ÏóÜÏùå</div>
                    <div style="color: #00d4ff; font-size: 1.5em; font-weight: 900; margin-bottom: 15px;" id="auctionTeam2Points">100P</div>
                    <input type="number" class="auction-bid-input" id="team2BidInput" placeholder="ÏûÖÏ∞∞Í∞Ä" min="0">
                    <button class="auction-bid-btn" id="team2BidBtn">ÏûÖÏ∞∞</button>
                </div>
            </div>

            <div class="auction-controls">
                <button class="auction-control-btn auction-pass-btn" id="auctionPassBtn">‚è≠Ô∏è Ïú†Ï∞∞</button>
                <button class="auction-control-btn auction-next-btn" id="auctionNextBtn">‚úì Îã§Ïùå</button>
                <button class="auction-control-btn auction-close-btn" id="auctionCloseBtn">‚úï Îã´Í∏∞</button>
            </div>

            <div class="auction-remaining-players" id="auctionRemainingPlayers">
                <div style="font-size: 0.85em; font-weight: 700; margin-bottom: 8px; color: rgba(255,255,255,0.6); text-align: center;">ÎåÄÍ∏∞ Ï§ëÏù∏ ÏÑ†Ïàò</div>
                <div class="auction-remaining-list" id="auctionRemainingList"></div>
            </div>
        </div>
    </div>

    <div class="modal" id="tierModal">
        <div class="modal-content">
            <div class="modal-title">Ìã∞Ïñ¥ ÏàòÏ†ï</div>
            <input type="number" class="modal-input" id="tierModalInput" min="1">
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="tierModalCancel">Ï∑®ÏÜå</button>
                <button class="modal-btn save" id="tierModalSave">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <div class="modal" id="roleModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-title">Ïó≠Ìï† ÏÑ†ÌÉù</div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                <div class="role-option" data-role="ÌÉ±Ïª§" style="padding: 25px; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.3); border-radius: 10px; cursor: pointer; text-align: center; font-size: 1.3em; transition: all 0.3s;">üõ°Ô∏è<br>ÌÉ±Ïª§</div>
                <div class="role-option" data-role="ÎîúÎü¨" style="padding: 25px; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.3); border-radius: 10px; cursor: pointer; text-align: center; font-size: 1.3em; transition: all 0.3s;">‚öîÔ∏è<br>ÎîúÎü¨</div>
                <div class="role-option" data-role="ÌûêÎü¨" style="padding: 25px; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.3); border-radius: 10px; cursor: pointer; text-align: center; font-size: 1.3em; transition: all 0.3s;">‚ù§Ô∏è<br>ÌûêÎü¨</div>
                <div class="role-option" data-role="ÎûúÎç§" style="padding: 25px; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.3); border-radius: 10px; cursor: pointer; text-align: center; font-size: 1.3em; transition: all 0.3s;">üé≤<br>ÎûúÎç§</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="roleModalCancel">Ï∑®ÏÜå</button>
                <button class="modal-btn save" id="roleModalSave">ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <div class="modal" id="templateNameModal">
        <div class="modal-content">
            <div class="modal-title">ÌÖúÌîåÎ¶ø Ïù¥Î¶Ñ</div>
            <input type="text" class="modal-input" id="templateNameInput" placeholder="ÌÖúÌîåÎ¶ø Ïù¥Î¶Ñ">
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="templateNameCancel">Ï∑®ÏÜå</button>
                <button class="modal-btn save" id="templateNameSave">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <script>
        let savedPlayers = [];
        let draggedElement = null;
        let sourceContainer = null;
        let nextPlayerId = 1;
        let editingPlayerId = null;
        let editingSpectatorId = null;
        let selectedRole = null;
        
        let team1Points = 100;
        let team2Points = 100;
        let auctionPlayers = [];
        let currentAuctionIndex = 0;
        let currentBid = { team: null, amount: 0 };
        let team1CaptainName = '';
        let team2CaptainName = '';

        let auctionTimer = null;
        let auctionTimeLeft = 6;

        let templates = [];
        let currentTemplateIndex = 0;
        const MAX_TEMPLATES = 5;

        const STORAGE_KEY_TEMPLATES = 'teamDivider_templates';
        const STORAGE_KEY_CURRENT = 'teamDivider_currentTemplate';

        function init() {
            loadTemplates();
            updateTemplateButtons();
            loadCurrentTemplate();
            updateTeamSlots();
            updateSavedPlayersUI();
            setupEventListeners();
            setupSpectatorsDragDrop();
            updateSidebarLists();
        }

        function loadTemplates() {
            const saved = localStorage.getItem(STORAGE_KEY_TEMPLATES);
            if (saved) {
                try {
                    templates = JSON.parse(saved);
                } catch (e) {
                    templates = [];
                }
            }
            
            while (templates.length < MAX_TEMPLATES) {
                templates.push({
                    name: `ÌÖúÌîåÎ¶ø ${templates.length + 1}`,
                    players: [],
                    nextId: 1
                });
            }

            const savedCurrent = localStorage.getItem(STORAGE_KEY_CURRENT);
            if (savedCurrent !== null) {
                currentTemplateIndex = parseInt(savedCurrent);
            }
        }

        function saveTemplates() {
            localStorage.setItem(STORAGE_KEY_TEMPLATES, JSON.stringify(templates));
            localStorage.setItem(STORAGE_KEY_CURRENT, currentTemplateIndex.toString());
        }

        function loadCurrentTemplate() {
            const template = templates[currentTemplateIndex];
            savedPlayers = template.players || [];
            nextPlayerId = template.nextId || 1;
        }

        function saveCurrentTemplate() {
            templates[currentTemplateIndex].players = savedPlayers;
            templates[currentTemplateIndex].nextId = nextPlayerId;
            saveTemplates();
        }

        function switchTemplate(index) {
            saveCurrentTemplate();
            currentTemplateIndex = index;
            loadCurrentTemplate();
            updateTemplateButtons();
            updateSavedPlayersUI();
            clearAll();
            saveTemplates();
            updateSidebarLists();
        }

        function updateTemplateButtons() {
            const container = document.getElementById('templateButtons');
            container.innerHTML = '';
            
            templates.forEach((template, index) => {
                const btn = document.createElement('button');
                btn.className = 'template-btn';
                if (index === currentTemplateIndex) {
                    btn.classList.add('active');
                }
                btn.textContent = template.name;
                btn.addEventListener('click', () => switchTemplate(index));
                container.appendChild(btn);
            });
        }

        function openTemplateNameModal() {
            const modal = document.getElementById('templateNameModal');
            const input = document.getElementById('templateNameInput');
            input.value = templates[currentTemplateIndex].name;
            modal.classList.add('active');
            input.focus();
        }

        function saveTemplateName() {
            const input = document.getElementById('templateNameInput');
            const newName = input.value.trim();
            
            if (newName === '') {
                alert('ÌÖúÌîåÎ¶ø Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            templates[currentTemplateIndex].name = newName;
            saveTemplates();
            updateTemplateButtons();
            
            document.getElementById('templateNameModal').classList.remove('active');
        }

        function getTeamPlayerNames() {
            const teamNames = new Set();
            const allSlots = document.querySelectorAll('.team-slot');
            
            allSlots.forEach(slot => {
                const card = slot.querySelector('.player-card');
                if (card) {
                    const player = JSON.parse(card.dataset.player);
                    teamNames.add(player.name);
                }
            });
            
            return teamNames;
        }

        function getSpectatorPlayerNames() {
            const spectatorNames = new Set();
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            const cards = spectatorsGrid.querySelectorAll('.spectator-card');
            
            cards.forEach(card => {
                const player = JSON.parse(card.dataset.player);
                spectatorNames.add(player.name);
            });
            
            return spectatorNames;
        }

        function calculateTeamSize() {
            const spectatorCount = getSpectatorPlayers().length;
            
            const team1Slots = document.querySelectorAll('#team1 .team-slot');
            const team2Slots = document.querySelectorAll('#team2 .team-slot');
            
            let team1Count = 0;
            let team2Count = 0;
            
            team1Slots.forEach(slot => {
                if (slot.querySelector('.player-card')) team1Count++;
            });
            
            team2Slots.forEach(slot => {
                if (slot.querySelector('.player-card')) team2Count++;
            });
            
            const totalPlayers = spectatorCount + team1Count + team2Count;
            return Math.ceil(totalPlayers / 2);
        }

        function startAuctionTimer() {
            stopAuctionTimer();
            auctionTimeLeft = 6;
            updateTimerDisplay();
            
            auctionTimer = setInterval(() => {
                auctionTimeLeft--;
                updateTimerDisplay();
                
                if (auctionTimeLeft <= 0) {
                    stopAuctionTimer();
                }
            }, 1000);
        }

        function stopAuctionTimer() {
            if (auctionTimer) {
                clearInterval(auctionTimer);
                auctionTimer = null;
            }
        }

        function resetAuctionTimer() {
            startAuctionTimer();
        }

        function updateAuctionRemainingList() {
            const remainingList = document.getElementById('auctionRemainingList');
            remainingList.innerHTML = '';
            
            for (let i = currentAuctionIndex; i < auctionPlayers.length; i++) {
                const player = auctionPlayers[i];
                const item = document.createElement('div');
                item.className = 'auction-remaining-item';
                if (i === currentAuctionIndex) {
                    item.classList.add('current');
                }
                item.textContent = `${player.name} (${player.tier})`;
                remainingList.appendChild(item);
            }
        }

        function updateTimerDisplay() {
            const timerElement = document.getElementById('auctionTimer');
            timerElement.textContent = auctionTimeLeft;
            
            if (auctionTimeLeft <= 3) {
                timerElement.classList.add('warning');
            } else {
                timerElement.classList.remove('warning');
            }
            
            if (auctionTimeLeft <= 0) {
                handleTimerEnd();
            }
        }

        function handleTimerEnd() {
            stopAuctionTimer();
            
            if (currentBid.team === null) {
                passAuction();
            } else {
                nextAuctionPlayer();
            }
        }

        function setupSpectatorsDragDrop() {
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            
            spectatorsGrid.addEventListener('dragover', handleSpectatorDragOver);
            spectatorsGrid.addEventListener('drop', handleSpectatorDrop);
        }

        function handleSpectatorDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleSpectatorDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            if (e.preventDefault) e.preventDefault();
            
            if (!draggedElement || !sourceContainer) return false;
            
            const player = JSON.parse(draggedElement.dataset.player);
            
            if (sourceContainer.classList.contains('team-slot')) {
                sourceContainer.innerHTML = '';
                sourceContainer.classList.add('empty');
                
                addToSpectators(player);
                updateTeamScores();
                updateSpectatorCount();
                updateSavedPlayersUI();
                updateTeamSlots();
                updateSidebarLists();
            }
            
            return false;
        }

        function addToSpectators(player) {
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            
            const spectatorNames = getSpectatorPlayerNames();
            if (spectatorNames.has(player.name)) return;
            
            spectatorsGrid.classList.remove('empty');
            const card = createSpectatorCard(player);
            spectatorsGrid.appendChild(card);
        }

        function createSpectatorCard(player) {
            const card = document.createElement('div');
            card.className = 'spectator-card';
            
            const roleIcons = {
                'ÌÉ±Ïª§': 'üõ°Ô∏è',
                'ÎîúÎü¨': '‚öîÔ∏è',
                'ÌûêÎü¨': '‚ù§Ô∏è',
                'ÎûúÎç§': 'üé≤'
            };
            
            card.innerHTML = `
                <button class="remove-spectator-btn">‚úï</button>
                ${player.name}
                <div class="tier-label">${player.tier}</div>
                ${player.role ? `<div class="role-label" style="cursor: pointer; margin-top: 5px; font-size: 0.8em; background: rgba(255,255,255,0.3); padding: 2px 6px; border-radius: 8px; display: inline-block;">${roleIcons[player.role] || 'üé≤'} ${player.role}</div>` : ''}
            `;
            card.draggable = true;
            card.dataset.player = JSON.stringify(player);
            
            card.addEventListener('dragstart', handleDragStart);
            card.addEventListener('dragend', handleDragEnd);
            
            const removeBtn = card.querySelector('.remove-spectator-btn');
            removeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                removeFromSpectators(player);
            });
            
            const roleLabel = card.querySelector('.role-label');
            if (roleLabel) {
                roleLabel.addEventListener('click', (e) => {
                    e.stopPropagation();
                    openRoleModal(player);
                });
            }
            
            return card;
        }

        function removeFromSpectators(player) {
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            const cards = spectatorsGrid.querySelectorAll('.spectator-card');
            
            cards.forEach(card => {
                const cardPlayer = JSON.parse(card.dataset.player);
                if (cardPlayer.id === player.id) {
                    card.remove();
                }
            });
            
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateTeamSlots();
            updateSidebarLists();
        }

        function updateSpectatorCount() {
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            const count = spectatorsGrid.querySelectorAll('.spectator-card').length;
            document.getElementById('spectatorCount').textContent = count;
            
            if (count === 0) {
                spectatorsGrid.classList.add('empty');
            } else {
                spectatorsGrid.classList.remove('empty');
            }
        }

        function updateSidebarLists() {
            const sidebarSpectators = document.getElementById('sidebarSpectators');
            sidebarSpectators.innerHTML = '';
            
            const spectatorPlayers = getSpectatorPlayers();
            if (spectatorPlayers.length === 0) {
                sidebarSpectators.innerHTML = '<span style="color: rgba(255,255,255,0.3);">Í¥ÄÏ†ÑÏûê ÏóÜÏùå</span>';
            } else {
                spectatorPlayers.forEach(player => {
                    const tag = document.createElement('div');
                    tag.className = 'saved-player-tag in-spectator';
                    tag.innerHTML = `${player.name} (${player.tier})`;
                    sidebarSpectators.appendChild(tag);
                });
            }
        }

        function setupEventListeners() {
            document.getElementById('addPlayerBtn').addEventListener('click', addPlayer);
            document.getElementById('newPlayerInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addPlayer();
            });

            document.getElementById('balancedBtn').addEventListener('click', balancedRandomAssign);
            document.getElementById('spectatorRandomBtn').addEventListener('click', spectatorRandomAssign);
            document.getElementById('auctionBtn').addEventListener('click', startAuction);
            document.getElementById('resetToSpectatorBtn').addEventListener('click', resetToSpectator);
            document.getElementById('addAllToSpectatorBtn').addEventListener('click', addAllToSpectator);
            document.getElementById('clearTeamsBtn').addEventListener('click', clearAll);

            document.getElementById('team1BidBtn').addEventListener('click', () => placeBid(1));
            document.getElementById('team2BidBtn').addEventListener('click', () => placeBid(2));
            document.getElementById('auctionPassBtn').addEventListener('click', passAuction);
            document.getElementById('auctionNextBtn').addEventListener('click', nextAuctionPlayer);
            document.getElementById('auctionCloseBtn').addEventListener('click', closeAuction);

            document.getElementById('team1BidInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') placeBid(1);
            });

            document.getElementById('team2BidInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') placeBid(2);
            });

            document.getElementById('team1BidInput').addEventListener('focus', function() {
                this.select();
            });

            document.getElementById('team2BidInput').addEventListener('focus', function() {
                this.select();
            });

            document.getElementById('team1BidInput').addEventListener('input', function() {
                const maxBid = team1Points;
                if (parseInt(this.value) > maxBid) {
                    this.value = maxBid;
                }
            });

            document.getElementById('team2BidInput').addEventListener('input', function() {
                const maxBid = team2Points;
                if (parseInt(this.value) > maxBid) {
                    this.value = maxBid;
                }
            });

            document.getElementById('auctionTeam1PointsInput').addEventListener('input', function() {
                team1Points = parseInt(this.value) || 0;
                document.getElementById('auctionTeam1Points').textContent = `${team1Points}P`;
            });

            document.getElementById('auctionTeam2PointsInput').addEventListener('input', function() {
                team2Points = parseInt(this.value) || 0;
                document.getElementById('auctionTeam2Points').textContent = `${team2Points}P`;
            });

            document.getElementById('tierModalCancel').addEventListener('click', () => {
                document.getElementById('tierModal').classList.remove('active');
            });
            document.getElementById('tierModalSave').addEventListener('click', saveTierChange);

            document.querySelectorAll('.role-option').forEach(opt => {
                opt.addEventListener('click', function() {
                    document.querySelectorAll('.role-option').forEach(o => {
                        o.style.background = 'rgba(0,0,0,0.3)';
                        o.style.borderColor = 'rgba(255,255,255,0.3)';
                    });
                    this.style.background = 'linear-gradient(135deg, #ff6b00 0%, #ff0080 100%)';
                    this.style.borderColor = '#ff6b00';
                    selectedRole = this.dataset.role;
                });
            });
            
            document.getElementById('roleModalCancel').addEventListener('click', () => {
                document.getElementById('roleModal').classList.remove('active');
                editingSpectatorId = null;
                selectedRole = null;
            });
            
            document.getElementById('roleModalSave').addEventListener('click', saveRoleChange);

            document.getElementById('saveTemplateBtn').addEventListener('click', () => {
                saveCurrentTemplate();
                alert('Ï†ÄÏû• ÏôÑÎ£å!');
            });
            document.getElementById('renameTemplateBtn').addEventListener('click', openTemplateNameModal);

            document.getElementById('templateNameCancel').addEventListener('click', () => {
                document.getElementById('templateNameModal').classList.remove('active');
            });
            document.getElementById('templateNameSave').addEventListener('click', saveTemplateName);
        }

        function addPlayer() {
            const input = document.getElementById('newPlayerInput');
            const tierInput = document.getElementById('newTierInput');
            const name = input.value.trim();
            const tier = parseInt(tierInput.value) || 3;

            if (name === '') {
                alert('Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }

            if (savedPlayers.some(p => p.name === name)) {
                alert('Ïù¥ÎØ∏ Îì±Î°ùÎêú Ïù¥Î¶ÑÏûÖÎãàÎã§!');
                return;
            }

            const newPlayer = {
                id: nextPlayerId++,
                name,
                tier,
                role: 'ÎûúÎç§'
            };

            savedPlayers.push(newPlayer);
            saveCurrentTemplate();
            input.value = '';
            tierInput.value = '3';
            
            updateSavedPlayersUI();
            updateSidebarLists();
        }

        function openRoleModal(player) {
            editingSpectatorId = player.id;
            selectedRole = player.role || 'ÎûúÎç§';
            
            document.querySelectorAll('.role-option').forEach(opt => {
                opt.style.background = 'rgba(0,0,0,0.3)';
                opt.style.borderColor = 'rgba(255,255,255,0.3)';
                if (opt.dataset.role === selectedRole) {
                    opt.style.background = 'linear-gradient(135deg, #ff6b00 0%, #ff0080 100%)';
                    opt.style.borderColor = '#ff6b00';
                }
            });
            
            document.getElementById('roleModal').classList.add('active');
        }

        function saveRoleChange() {
            if (!selectedRole) {
                alert('Ïó≠Ìï†ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }

            const spectatorsGrid = document.getElementById('spectatorsGrid');
            const cards = spectatorsGrid.querySelectorAll('.spectator-card');
            
            cards.forEach(card => {
                const player = JSON.parse(card.dataset.player);
                if (player.id === editingSpectatorId) {
                    player.role = selectedRole;
                    card.dataset.player = JSON.stringify(player);
                    
                    const roleIcons = {
                        'ÌÉ±Ïª§': 'üõ°Ô∏è',
                        'ÎîúÎü¨': '‚öîÔ∏è',
                        'ÌûêÎü¨': '‚ù§Ô∏è',
                        'ÎûúÎç§': 'üé≤'
                    };
                    
                    const roleLabel = card.querySelector('.role-label');
                    if (roleLabel) {
                        roleLabel.innerHTML = `${roleIcons[selectedRole]} ${selectedRole}`;
                    }
                }
            });
            
            document.getElementById('roleModal').classList.remove('active');
            editingSpectatorId = null;
            selectedRole = null;
            updateSidebarLists();
        }

        function removePlayer(id) {
            const player = savedPlayers.find(p => p.id === id);
            if (!player) return;
            
            if (confirm(`"${player.name}"ÏùÑ(Î•º) ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                savedPlayers = savedPlayers.filter(p => p.id !== id);
                
                const spectatorsGrid = document.getElementById('spectatorsGrid');
                const cards = spectatorsGrid.querySelectorAll('.spectator-card');
                cards.forEach(card => {
                    const cardPlayer = JSON.parse(card.dataset.player);
                    if (cardPlayer.id === id) card.remove();
                });
                
                const allSlots = document.querySelectorAll('.team-slot');
                allSlots.forEach(slot => {
                    const card = slot.querySelector('.player-card');
                    if (card) {
                        const cardPlayer = JSON.parse(card.dataset.player);
                        if (cardPlayer.id === id) {
                            slot.innerHTML = '';
                            slot.classList.add('empty');
                        }
                    }
                });
                
                saveCurrentTemplate();
                updateSavedPlayersUI();
                updateSpectatorCount();
                updateTeamScores();
                updateTeamSlots();
                updateSidebarLists();
            }
        }

        function openTierModal(player) {
            editingPlayerId = player.id;
            document.getElementById('tierModalInput').value = player.tier;
            document.getElementById('tierModal').classList.add('active');
            document.getElementById('tierModalInput').focus();
        }

        function saveTierChange() {
            const newTier = parseInt(document.getElementById('tierModalInput').value);
            
            if (isNaN(newTier) || newTier < 1) {
                alert('1 Ïù¥ÏÉÅÏùò Ïà´ÏûêÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }

            const player = savedPlayers.find(p => p.id === editingPlayerId);
            if (player) {
                player.tier = newTier;
                saveCurrentTemplate();
                updatePlayerCardsEverywhere(player);
                updateSavedPlayersUI();
                updateTeamScores();
                updateSidebarLists();
            }
            
            document.getElementById('tierModal').classList.remove('active');
        }

        function updatePlayerCardsEverywhere(player) {
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            const spectatorCards = spectatorsGrid.querySelectorAll('.spectator-card');
            spectatorCards.forEach(card => {
                const cardPlayer = JSON.parse(card.dataset.player);
                if (cardPlayer.id === player.id) {
                    cardPlayer.tier = player.tier;
                    card.dataset.player = JSON.stringify(cardPlayer);
                    card.querySelector('.tier-label').textContent = player.tier;
                }
            });

            const allSlots = document.querySelectorAll('.team-slot');
            allSlots.forEach(slot => {
                const card = slot.querySelector('.player-card');
                if (card) {
                    const cardPlayer = JSON.parse(card.dataset.player);
                    if (cardPlayer.id === player.id) {
                        cardPlayer.tier = player.tier;
                        card.dataset.player = JSON.stringify(cardPlayer);
                        card.querySelector('.tier-label').textContent = player.tier;
                    }
                }
            });
        }

        function selectPlayer(player) {
            const teamNames = getTeamPlayerNames();
            if (teamNames.has(player.name)) {
                alert(`${player.name}ÏùÄ(Îäî) Ïù¥ÎØ∏ ÌåÄÏóê ÏûàÏäµÎãàÎã§!`);
                return;
            }

            const spectatorNames = getSpectatorPlayerNames();
            if (spectatorNames.has(player.name)) {
                alert(`${player.name}ÏùÄ(Îäî) Ïù¥ÎØ∏ Í¥ÄÏ†ÑÏûêÏóê ÏûàÏäµÎãàÎã§!`);
                return;
            }
            
            addToSpectators(player);
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateTeamSlots();
            updateSidebarLists();
        }

        function updateSavedPlayersUI() {
            const container = document.getElementById('savedPlayers');
            container.innerHTML = '';

            if (savedPlayers.length === 0) {
                container.innerHTML = '<span style="color: rgba(255,255,255,0.3);">Ï∞∏Í∞ÄÏûê ÏóÜÏùå</span>';
                return;
            }

            const teamNames = getTeamPlayerNames();
            const spectatorNames = getSpectatorPlayerNames();

            savedPlayers.forEach(player => {
                const tag = document.createElement('div');
                tag.className = 'saved-player-tag';
                
                if (teamNames.has(player.name)) {
                    tag.classList.add('in-team');
                } else if (spectatorNames.has(player.name)) {
                    tag.classList.add('in-spectator');
                } else {
                    tag.addEventListener('click', () => selectPlayer(player));
                }

                tag.innerHTML = `${player.name} (${player.tier})`;
                
                tag.addEventListener('dblclick', () => openTierModal(player));
                tag.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    removePlayer(player.id);
                });

                container.appendChild(tag);
            });
        }

        function updateTeamSlots() {
            const teamSize = calculateTeamSize();
            const team1 = document.getElementById('team1');
            const team2 = document.getElementById('team2');
            
            const team1Players = [];
            const team2Players = [];
            
            team1.querySelectorAll('.player-card').forEach(card => {
                team1Players.push(JSON.parse(card.dataset.player));
            });
            
            team2.querySelectorAll('.player-card').forEach(card => {
                team2Players.push(JSON.parse(card.dataset.player));
            });
            
            team1.innerHTML = '';
            team2.innerHTML = '';
            
            for (let i = 0; i < teamSize; i++) {
                const slot1 = createSlot('team1', i);
                const slot2 = createSlot('team2', i);
                
                if (i < team1Players.length) {
                    slot1.innerHTML = '';
                    slot1.classList.remove('empty');
                    const card = createPlayerCard(team1Players[i]);
                    slot1.appendChild(card);
                }
                
                if (i < team2Players.length) {
                    slot2.innerHTML = '';
                    slot2.classList.remove('empty');
                    const card = createPlayerCard(team2Players[i]);
                    slot2.appendChild(card);
                }
                
                team1.appendChild(slot1);
                team2.appendChild(slot2);
            }

            updateTeamScores();
        }

        function createSlot(teamId, index) {
            const slot = document.createElement('div');
            slot.className = 'team-slot empty';
            slot.dataset.team = teamId;
            slot.dataset.index = index;
            
            slot.addEventListener('dragover', handleDragOver);
            slot.addEventListener('drop', handleDrop);
            
            return slot;
        }

        function createPlayerCard(player) {
            const card = document.createElement('div');
            card.className = 'player-card';
            card.innerHTML = `
                ${player.name}
                <div class="tier-label">${player.tier}</div>
                ${player.role ? `<div class="role-label">${player.role}</div>` : ''}
            `;
            card.draggable = true;
            card.dataset.player = JSON.stringify(player);
            
            card.addEventListener('dragstart', handleDragStart);
            card.addEventListener('dragend', handleDragEnd);
            
            return card;
        }

        function handleDragStart(e) {
            draggedElement = e.target;
            sourceContainer = e.target.parentElement;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            
            updateTeamScores();
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateSidebarLists();
        }

        function handleDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            if (e.preventDefault) e.preventDefault();
            
            const targetSlot = e.currentTarget;
            
            if (!draggedElement || !sourceContainer) return false;
            if (sourceContainer === targetSlot) return false;
            
            const player = JSON.parse(draggedElement.dataset.player);
            const existingCard = targetSlot.querySelector('.player-card');
            
            if (existingCard) {
                const existingPlayer = JSON.parse(existingCard.dataset.player);
                
                targetSlot.innerHTML = '';
                targetSlot.classList.remove('empty');
                
                if (sourceContainer.classList.contains('team-slot')) {
                    sourceContainer.innerHTML = '';
                    sourceContainer.classList.remove('empty');
                    const newCard2 = createPlayerCard(existingPlayer);
                    sourceContainer.appendChild(newCard2);
                } else if (sourceContainer.classList.contains('spectators-grid')) {
                    draggedElement.remove();
                    addToSpectators(existingPlayer);
                }
                
                const newCard1 = createPlayerCard(player);
                targetSlot.appendChild(newCard1);
                
            } else {
                if (sourceContainer.classList.contains('team-slot')) {
                    sourceContainer.innerHTML = '';
                    sourceContainer.classList.add('empty');
                } else if (sourceContainer.classList.contains('spectators-grid')) {
                    draggedElement.remove();
                }
                
                targetSlot.innerHTML = '';
                targetSlot.classList.remove('empty');
                const newCard = createPlayerCard(player);
                targetSlot.appendChild(newCard);
            }
            
            updateTeamScores();
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateSidebarLists();
            return false;
        }

        function updateTeamScores() {
            const team1Slots = document.querySelectorAll('#team1 .team-slot');
            const team2Slots = document.querySelectorAll('#team2 .team-slot');
            
            let team1Score = 0;
            let team2Score = 0;
            
            team1Slots.forEach(slot => {
                const card = slot.querySelector('.player-card');
                if (card) {
                    const player = JSON.parse(card.dataset.player);
                    team1Score += player.tier;
                }
            });
            
            team2Slots.forEach(slot => {
                const card = slot.querySelector('.player-card');
                if (card) {
                    const player = JSON.parse(card.dataset.player);
                    team2Score += player.tier;
                }
            });
            
            document.getElementById('team1Score').textContent = team1Score;
            document.getElementById('team2Score').textContent = team2Score;
            
            const diff = Math.abs(team1Score - team2Score);
            const diffElement = document.getElementById('scoreDiff');
            diffElement.textContent = diff;
            
            if (diff <= 1) {
                diffElement.classList.add('balanced');
            } else {
                diffElement.classList.remove('balanced');
            }
        }

        function getSpectatorPlayers() {
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            const cards = spectatorsGrid.querySelectorAll('.spectator-card');
            const players = [];
            
            cards.forEach(card => {
                players.push(JSON.parse(card.dataset.player));
            });
            
            return players;
        }

        function balancedRandomAssign() {
            const spectatorPlayers = getSpectatorPlayers();
            
            if (spectatorPlayers.length === 0) {
                alert('Í¥ÄÏ†ÑÏûêÎ•º Î®ºÏ†Ä Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }

            if (spectatorPlayers.length < 2) {
                alert('ÏµúÏÜå 2Î™Ö Ïù¥ÏÉÅ ÌïÑÏöîÌï©ÎãàÎã§!');
                return;
            }

            clearTeams();
            
            const teamSize = calculateTeamSize();
            updateTeamSlots();

            const maxPlayers = teamSize * 2;
            const playersToAssign = spectatorPlayers.slice(0, Math.min(spectatorPlayers.length, maxPlayers));
            const remainingSpectators = spectatorPlayers.slice(maxPlayers);

            let bestAssignment = null;
            let bestScore = Infinity;
            const attempts = 10000;

            for (let i = 0; i < attempts; i++) {
                const shuffled = [...playersToAssign].sort(() => Math.random() - 0.5);
                const team1 = shuffled.slice(0, teamSize);
                const team2 = shuffled.slice(teamSize, teamSize * 2);
                
                const team1TierScore = team1.reduce((sum, p) => sum + p.tier, 0);
                const team2TierScore = team2.reduce((sum, p) => sum + p.tier, 0);
                const tierDiff = Math.abs(team1TierScore - team2TierScore);
                
                if (tierDiff < bestScore) {
                    bestScore = tierDiff;
                    bestAssignment = shuffled;
                    
                    if (tierDiff === 0) break;
                }
            }

            if (bestAssignment) {
                assignPlayersToTeams(bestAssignment, teamSize);
                
                const spectatorsGrid = document.getElementById('spectatorsGrid');
                spectatorsGrid.innerHTML = '';
                remainingSpectators.forEach(player => addToSpectators(player));
                updateSpectatorCount();
                updateSavedPlayersUI();
                updateSidebarLists();
                
                if (bestScore === 0) {
                    setTimeout(() => alert('üéØ ÏôÑÎ≤ΩÌïú Î∞∏Îü∞Ïä§!'), 100);
                }
            }
        }

        function spectatorRandomAssign() {
            const spectatorPlayers = getSpectatorPlayers();
            
            if (spectatorPlayers.length === 0) {
                alert('Í¥ÄÏ†ÑÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§!');
                return;
            }

            const team1Slots = document.querySelectorAll('#team1 .team-slot');
            const team2Slots = document.querySelectorAll('#team2 .team-slot');
            
            let emptyCount = 0;
            [...team1Slots, ...team2Slots].forEach(slot => {
                if (slot.classList.contains('empty') || !slot.querySelector('.player-card')) {
                    emptyCount++;
                }
            });
            
            if (emptyCount === 0) {
                alert('Îπà ÏûêÎ¶¨Í∞Ä ÏóÜÏäµÎãàÎã§!');
                return;
            }

            const teamSize = calculateTeamSize();
            const playersToAssign = Math.min(spectatorPlayers.length, emptyCount);
            
            const shuffled = [...spectatorPlayers].sort(() => Math.random() - 0.5);
            
            let playerIndex = 0;
            
            team1Slots.forEach(slot => {
                if ((slot.classList.contains('empty') || !slot.querySelector('.player-card')) && playerIndex < playersToAssign) {
                    slot.innerHTML = '';
                    slot.classList.remove('empty');
                    const card = createPlayerCard(shuffled[playerIndex]);
                    slot.appendChild(card);
                    playerIndex++;
                }
            });
            
            team2Slots.forEach(slot => {
                if ((slot.classList.contains('empty') || !slot.querySelector('.player-card')) && playerIndex < playersToAssign) {
                    slot.innerHTML = '';
                    slot.classList.remove('empty');
                    const card = createPlayerCard(shuffled[playerIndex]);
                    slot.appendChild(card);
                    playerIndex++;
                }
            });
            
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            spectatorsGrid.innerHTML = '';
            
            for (let i = playerIndex; i < spectatorPlayers.length; i++) {
                addToSpectators(spectatorPlayers[i]);
            }
            
            updateSpectatorCount();
            updateTeamScores();
            updateSavedPlayersUI();
            updateSidebarLists();
        }

        function resetToSpectator() {
            const team1Players = getTeamPlayers(1);
            const team2Players = getTeamPlayers(2);
            
            const allPlayers = [...team1Players, ...team2Players];
            
            if (allPlayers.length === 0) {
                alert('ÌåÄÏóê Î∞∞ÏπòÎêú ÏÑ†ÏàòÍ∞Ä ÏóÜÏäµÎãàÎã§!');
                return;
            }
            
            clearTeams();
            
            allPlayers.forEach(player => {
                addToSpectators(player);
            });
            
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateSidebarLists();
        }

        function addAllToSpectator() {
            savedPlayers.forEach(player => {
                const spectatorNames = getSpectatorPlayerNames();
                const teamNames = getTeamPlayerNames();
                
                if (!spectatorNames.has(player.name) && !teamNames.has(player.name)) {
                    addToSpectators(player);
                }
            });
            
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateSidebarLists();
        }

        function startAuction() {
            const spectatorPlayers = getSpectatorPlayers();
            
            if (spectatorPlayers.length === 0) {
                alert('Í≤ΩÎß§Ìï† Í¥ÄÏ†ÑÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§!');
                return;
            }

            if (spectatorPlayers.length < 2) {
                alert('ÏµúÏÜå 2Î™Ö Ïù¥ÏÉÅ ÌïÑÏöîÌï©ÎãàÎã§!');
                return;
            }

            const teamSize = calculateTeamSize();
            updateTeamSlots();

            auctionPlayers = [...spectatorPlayers].sort(() => Math.random() - 0.5);
            currentAuctionIndex = 0;
            currentBid = { team: null, amount: 0 };
            
            team1Points = 100;
            team2Points = 100;
            
            const team1Players = getTeamPlayers(1);
            const team2Players = getTeamPlayers(2);
            
            if (team1Players.length > 0) {
                const captain = team1Players.sort((a, b) => b.tier - a.tier)[0];
                team1CaptainName = captain.name;
            } else {
                team1CaptainName = '';
            }
            
            if (team2Players.length > 0) {
                const captain = team2Players.sort((a, b) => b.tier - a.tier)[0];
                team2CaptainName = captain.name;
            } else {
                team2CaptainName = '';
            }
            
            showAuctionModal();
        }

        function getTeamPlayers(teamNum) {
            const slots = teamNum === 1 ? 
                document.querySelectorAll('#team1 .team-slot') :
                document.querySelectorAll('#team2 .team-slot');
            
            const players = [];
            slots.forEach(slot => {
                const card = slot.querySelector('.player-card');
                if (card) {
                    players.push(JSON.parse(card.dataset.player));
                }
            });
            return players;
        }

        function showAuctionModal() {
            if (currentAuctionIndex >= auctionPlayers.length) {
                alert('Í≤ΩÎß§ Ï¢ÖÎ£å!');
                closeAuction();
                return;
            }

            const player = auctionPlayers[currentAuctionIndex];
            
            const roleIcons = {
                'ÌÉ±Ïª§': 'üõ°Ô∏è',
                'ÎîúÎü¨': '‚öîÔ∏è',
                'ÌûêÎü¨': '‚ù§Ô∏è',
                'ÎûúÎç§': 'üé≤'
            };
            
            document.getElementById('auctionPlayerName').textContent = player.name;
            document.getElementById('auctionPlayerTier').textContent = `Ìã∞Ïñ¥: ${player.tier} | ${roleIcons[player.role] || 'üé≤'} ${player.role || 'ÎûúÎç§'}`;
            
            const team1Players = getTeamPlayers(1);
            const team2Players = getTeamPlayers(2);
            
            document.getElementById('auctionTeam1Name').textContent = team1CaptainName ? `1ÌåÄ (${team1CaptainName})` : '1ÌåÄ';
            document.getElementById('auctionTeam2Name').textContent = team2CaptainName ? `2ÌåÄ (${team2CaptainName})` : '2ÌåÄ';
            
            document.getElementById('auctionTeam1Captain').textContent = `ÌåÄÏû•: ${team1CaptainName || '-'}`;
            document.getElementById('auctionTeam2Captain').textContent = `ÌåÄÏû•: ${team2CaptainName || '-'}`;
            
            const team1MembersList = team1Players.map(p => `${p.name}(${p.tier})`).join(', ');
            const team2MembersList = team2Players.map(p => `${p.name}(${p.tier})`).join(', ');
            
            document.getElementById('auctionTeam1Members').textContent = team1Players.length > 0 ? team1MembersList : 'Íµ¨ÏÑ±Ïõê ÏóÜÏùå';
            document.getElementById('auctionTeam2Members').textContent = team2Players.length > 0 ? team2MembersList : 'Íµ¨ÏÑ±Ïõê ÏóÜÏùå';
            
            document.getElementById('auctionTeam1PointsInput').value = team1Points;
            document.getElementById('auctionTeam2PointsInput').value = team2Points;
            
            document.getElementById('auctionTeam1Points').textContent = `${team1Points}P`;
            document.getElementById('auctionTeam2Points').textContent = `${team2Points}P`;
            
            document.getElementById('team1BidInput').value = '';
            document.getElementById('team2BidInput').value = '';
            document.getElementById('team1BidInput').max = team1Points;
            document.getElementById('team2BidInput').max = team2Points;
            
            currentBid = { team: null, amount: 0 };
            
            document.getElementById('team1BidBtn').disabled = team1Points === 0;
            document.getElementById('team2BidBtn').disabled = team2Points === 0;
            
            document.getElementById('auctionTeam1Side').classList.remove('winner');
            document.getElementById('auctionTeam2Side').classList.remove('winner');
            document.getElementById('auctionTeam1Side').classList.remove('current-bidder');
            document.getElementById('auctionTeam2Side').classList.remove('current-bidder');
            
            document.getElementById('auctionModal').classList.add('active');

            startAuctionTimer();

            updateAuctionRemainingList();

            setTimeout(() => {
                const firstInput = document.getElementById('team1BidInput');
                firstInput.focus();
                firstInput.select();
            }, 100);
        }

        function placeBid(team) {
            const inputId = team === 1 ? 'team1BidInput' : 'team2BidInput';
            const bidAmount = parseInt(document.getElementById(inputId).value);
            const teamPoints = team === 1 ? team1Points : team2Points;
            
            if (isNaN(bidAmount) || bidAmount < 0) {
                alert('Ïò¨Î∞îÎ•∏ ÏûÖÏ∞∞Í∞ÄÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            if (bidAmount > teamPoints) {
                alert('Î≥¥Ïú† Ìè¨Ïù∏Ìä∏Î•º Ï¥àÍ≥ºÌñàÏäµÎãàÎã§!');
                return;
            }
            
            if (bidAmount <= currentBid.amount) {
                alert(`ÌòÑÏû¨ ÏûÖÏ∞∞Í∞Ä(${currentBid.amount}P)Î≥¥Îã§ ÎÜíÍ≤å ÏûÖÏ∞∞Ìï¥Ïïº Ìï©ÎãàÎã§!`);
                return;
            }
            
            currentBid = { team, amount: bidAmount };
            
            document.getElementById('auctionTeam1Side').classList.remove('current-bidder');
            document.getElementById('auctionTeam2Side').classList.remove('current-bidder');
            
            if (team === 1) {
                document.getElementById('auctionTeam1Side').classList.add('current-bidder');
            } else {
                document.getElementById('auctionTeam2Side').classList.add('current-bidder');
            }
            
            resetAuctionTimer();
            
            const oppositeInputId = team === 1 ? 'team2BidInput' : 'team1BidInput';
            const oppositeInput = document.getElementById(oppositeInputId);
            oppositeInput.focus();
            oppositeInput.select();
        }

        function passAuction() {
            if (currentBid.team !== null) {
                alert('Ïù¥ÎØ∏ ÏûÖÏ∞∞Ïù¥ ÏûàÏäµÎãàÎã§!');
                return;
            }
            
            const passedPlayer = auctionPlayers[currentAuctionIndex];
            auctionPlayers.splice(currentAuctionIndex, 1);
            auctionPlayers.push(passedPlayer);
            
            resetAuctionTimer();
            
            if (currentAuctionIndex < auctionPlayers.length) {
                currentBid = { team: null, amount: 0 };
                showAuctionModal();
            } else {
                alert('Í≤ΩÎß§ Ï¢ÖÎ£å!');
                closeAuction();
            }
        }

        function nextAuctionPlayer() {
            if (currentBid.team === null) {
                if (team1Points === 0 && team2Points > 0) {
                    currentBid = { team: 2, amount: 0 };
                } else if (team2Points === 0 && team1Points > 0) {
                    currentBid = { team: 1, amount: 0 };
                } else {
                    alert('ÏûÖÏ∞∞Ïù¥ ÏóÜÏäµÎãàÎã§!');
                    return;
                }
            }
            
            const player = auctionPlayers[currentAuctionIndex];
            const team = currentBid.team;
            const amount = currentBid.amount;
            
            if (team === 1) {
                team1Points -= amount;
                document.getElementById('auctionTeam1Side').classList.add('winner');
            } else {
                team2Points -= amount;
                document.getElementById('auctionTeam2Side').classList.add('winner');
            }
            
            addPlayerToTeam(player, team);
            removeFromSpectators(player);
            
            currentAuctionIndex++;
            
            resetAuctionTimer();
            
            setTimeout(() => {
                if (currentAuctionIndex < auctionPlayers.length) {
                    if (team1Points === 0 || team2Points === 0) {
                        stopAuctionTimer();
                        autoAssignRemaining();
                    } else {
                        showAuctionModal();
                    }
                } else {
                    stopAuctionTimer();
                    alert('üéâ Í≤ΩÎß§ Ï¢ÖÎ£å!');
                    closeAuction();
                }
            }, 1000);
        }

        function autoAssignRemaining() {
            const remainingPlayers = auctionPlayers.slice(currentAuctionIndex);
            const targetTeam = team1Points === 0 ? 2 : 1;
            
            remainingPlayers.forEach(player => {
                addPlayerToTeam(player, targetTeam);
                removeFromSpectators(player);
            });
            
            alert(`üéâ Í≤ΩÎß§ Ï¢ÖÎ£å! ÎÇ®ÏùÄ ÏÑ†ÏàòÎäî ${targetTeam}ÌåÄÏóê Î∞∞Ï†ïÎêòÏóàÏäµÎãàÎã§.`);
            closeAuction();
        }

        function addPlayerToTeam(player, team) {
            const teamSlots = team === 1 ? 
                document.querySelectorAll('#team1 .team-slot') : 
                document.querySelectorAll('#team2 .team-slot');
            
            for (let slot of teamSlots) {
                if (slot.classList.contains('empty') || !slot.querySelector('.player-card')) {
                    slot.innerHTML = '';
                    slot.classList.remove('empty');
                    const card = createPlayerCard(player);
                    slot.appendChild(card);
                    break;
                }
            }
            
            const team1Players = getTeamPlayers(1);
            const team2Players = getTeamPlayers(2);
            
            if (team === 1 && team1Players.length > 0 && !team1CaptainName) {
                const captain = team1Players.sort((a, b) => b.tier - a.tier)[0];
                team1CaptainName = captain.name;
            }
            
            if (team === 2 && team2Players.length > 0 && !team2CaptainName) {
                const captain = team2Players.sort((a, b) => b.tier - a.tier)[0];
                team2CaptainName = captain.name;
            }
            
            const team1MembersList = team1Players.map(p => `${p.name}(${p.tier})`).join(', ');
            const team2MembersList = team2Players.map(p => `${p.name}(${p.tier})`).join(', ');
            
            document.getElementById('auctionTeam1Members').textContent = team1Players.length > 0 ? team1MembersList : 'Íµ¨ÏÑ±Ïõê ÏóÜÏùå';
            document.getElementById('auctionTeam2Members').textContent = team2Players.length > 0 ? team2MembersList : 'Íµ¨ÏÑ±Ïõê ÏóÜÏùå';
            
            document.getElementById('auctionTeam1Captain').textContent = `ÌåÄÏû•: ${team1CaptainName || '-'}`;
            document.getElementById('auctionTeam2Captain').textContent = `ÌåÄÏû•: ${team2CaptainName || '-'}`;
            
            updateTeamScores();
            updateSavedPlayersUI();
            updateSidebarLists();
        }

        function closeAuction() {
            stopAuctionTimer();
            document.getElementById('auctionModal').classList.remove('active');
        }

        function assignPlayersToTeams(players, teamSize) {
            const team1Slots = document.querySelectorAll('#team1 .team-slot');
            const team2Slots = document.querySelectorAll('#team2 .team-slot');
            
            let index = 0;
            
            for (let i = 0; i < teamSize && index < players.length; i++) {
                team1Slots[i].innerHTML = '';
                team1Slots[i].classList.remove('empty');
                const card = createPlayerCard(players[index]);
                team1Slots[i].appendChild(card);
                index++;
            }
            
            for (let i = 0; i < teamSize && index < players.length; i++) {
                team2Slots[i].innerHTML = '';
                team2Slots[i].classList.remove('empty');
                const card = createPlayerCard(players[index]);
                team2Slots[i].appendChild(card);
                index++;
            }
            
            updateTeamScores();
        }

        function clearTeams() {
            const team1Slots = document.querySelectorAll('#team1 .team-slot');
            const team2Slots = document.querySelectorAll('#team2 .team-slot');
            
            [...team1Slots, ...team2Slots].forEach(slot => {
                slot.innerHTML = '';
                slot.classList.add('empty');
            });
            
            updateTeamScores();
        }

        function clearAll() {
            clearTeams();
            
            const spectatorsGrid = document.getElementById('spectatorsGrid');
            spectatorsGrid.innerHTML = '';
            
            team1Points = 100;
            team2Points = 100;
            
            updateSpectatorCount();
            updateSavedPlayersUI();
            updateTeamSlots();
            updateSidebarLists();
        }

        init();
    </script>
</body>
</html>
